"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[3913],{6593:(r,n,e)=>{e.r(n),e.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"arquitetura-cicd-infraestrutura-advanced","title":"Arquitetura, CI/CD e Infraestrutura - Fluxos Avan\xe7ados","description":"Documenta\xe7\xe3o completa sobre como o projeto est\xe1 estruturado, como funciona o CI/CD e como \xe9 feito o acesso externo.","source":"@site/docs/arquitetura-cicd-infraestrutura-advanced.md","sourceDirName":".","slug":"/arquitetura-cicd-infraestrutura-advanced","permalink":"/OColecionador/docs/arquitetura-cicd-infraestrutura-advanced","draft":false,"unlisted":false,"editUrl":"https://github.com/PatrickCalorioCarvalho/OColecionador/edit/main/Documentation/docs/docs/arquitetura-cicd-infraestrutura-advanced.md","tags":[],"version":"current","frontMatter":{"id":"arquitetura-cicd-infraestrutura-advanced","title":"Arquitetura, CI/CD e Infraestrutura - Fluxos Avan\xe7ados","sidebar_label":"Avan\xe7ado"},"sidebar":"docs","previous":{"title":"Introdu\xe7\xe3o","permalink":"/OColecionador/docs/arquitetura-cicd-infraestrutura"}}');var a=e(4848),i=e(8453);const s={id:"arquitetura-cicd-infraestrutura-advanced",title:"Arquitetura, CI/CD e Infraestrutura - Fluxos Avan\xe7ados",sidebar_label:"Avan\xe7ado"},t="\ud83c\udfd7\ufe0f Arquitetura, CI/CD e Infraestrutura - Fluxos Avan\xe7ados",c={},l=[{value:"\ud83d\udccb Vis\xe3o Geral da Infraestrutura",id:"-vis\xe3o-geral-da-infraestrutura",level:2},{value:"\ud83d\udd04 CI/CD Pipeline",id:"-cicd-pipeline",level:2},{value:"GitHub Actions Workflows",id:"github-actions-workflows",level:3},{value:"Fluxo 1: Build Expo React Native APK",id:"fluxo-1-build-expo-react-native-apk",level:3},{value:"Fluxo 2: Deploy Docker Hub",id:"fluxo-2-deploy-docker-hub",level:3},{value:"Fluxo 3: Self-Hosted Docker Compose",id:"fluxo-3-self-hosted-docker-compose",level:3},{value:"\ud83c\udf0d Acesso Externo via ngrok",id:"-acesso-externo-via-ngrok",level:2},{value:"Configura\xe7\xe3o de Tunneling",id:"configura\xe7\xe3o-de-tunneling",level:3},{value:"Arquivo: docker-compose.yml (ngrok)",id:"arquivo-docker-composeyml-ngrok",level:3},{value:"Configura\xe7\xe3o ngrok (ngrok.yml)",id:"configura\xe7\xe3o-ngrok-ngrokyml",level:3},{value:"\ud83d\udd0c Nginx - Reverse Proxy",id:"-nginx---reverse-proxy",level:2},{value:"Arquivo: LocalServer/nginx.conf",id:"arquivo-localservernginxconf",level:3},{value:"\ud83d\udc33 Docker Compose - Infraestrutura Completa",id:"-docker-compose---infraestrutura-completa",level:2},{value:"Estrutura de Servi\xe7os",id:"estrutura-de-servi\xe7os",level:3},{value:"Exemplo Completo: docker-compose.yml",id:"exemplo-completo-docker-composeyml",level:3},{value:"\ud83d\ude80 Execu\xe7\xe3o com Perfis",id:"-execu\xe7\xe3o-com-perfis",level:2},{value:"Perfil: Autom\xe1tico (Produ\xe7\xe3o)",id:"perfil-autom\xe1tico-produ\xe7\xe3o",level:3},{value:"Perfil: Manual (Desenvolvimento)",id:"perfil-manual-desenvolvimento",level:3},{value:"Todos os Servi\xe7os",id:"todos-os-servi\xe7os",level:3},{value:"\ud83d\udd10 Vari\xe1veis de Ambiente (.env)",id:"-vari\xe1veis-de-ambiente-env",level:2},{value:"\ud83d\udcca Dashboard e Ferramentas",id:"-dashboard-e-ferramentas",level:2},{value:"Acesso aos Pain\xe9is",id:"acesso-aos-pain\xe9is",level:3},{value:"\ud83d\udd0d Monitoramento de Health Checks",id:"-monitoramento-de-health-checks",level:2},{value:"Comando para Verificar Sa\xfade",id:"comando-para-verificar-sa\xfade",level:3},{value:"\ud83d\udea8 Troubleshooting",id:"-troubleshooting",level:2},{value:"Backend n\xe3o conecta ao SQL Server",id:"backend-n\xe3o-conecta-ao-sql-server",level:3},{value:"Ngrok n\xe3o conecta",id:"ngrok-n\xe3o-conecta",level:3},{value:"Augmentations n\xe3o consome da fila",id:"augmentations-n\xe3o-consome-da-fila",level:3},{value:"\ud83d\udcc8 Fluxo Completo de Deployment",id:"-fluxo-completo-de-deployment",level:2},{value:"\ud83c\udfaf Conclus\xe3o",id:"-conclus\xe3o",level:2}];function d(r){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...r.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"\ufe0f-arquitetura-cicd-e-infraestrutura---fluxos-avan\xe7ados",children:"\ud83c\udfd7\ufe0f Arquitetura, CI/CD e Infraestrutura - Fluxos Avan\xe7ados"})}),"\n",(0,a.jsx)(n.p,{children:"Documenta\xe7\xe3o completa sobre como o projeto est\xe1 estruturado, como funciona o CI/CD e como \xe9 feito o acesso externo."}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-vis\xe3o-geral-da-infraestrutura",children:"\ud83d\udccb Vis\xe3o Geral da Infraestrutura"}),"\n",(0,a.jsx)(n.mermaid,{value:'graph TB\r\n    subgraph External["\ud83c\udf0d Acesso Externo"]\r\n        ngrok["\ud83d\udd17 ngrok<br/>Tunneling"]\r\n        domain["\ud83c\udf10 Domain<br/>louse-model-lioness.ngrok-free.app"]\r\n    end\r\n\r\n    subgraph CI["\ud83d\udd04 CI/CD"]\r\n        github["\ud83d\udc19 GitHub<br/>Repository"]\r\n        actions["\u2699\ufe0f GitHub Actions<br/>Workflows"]\r\n        selfhosted["\ud83d\udda5\ufe0f Self-Hosted Runner<br/>Runner Linux"]\r\n    end\r\n\r\n    subgraph LocalServer["\ud83c\udfe0 LocalServer"]\r\n        env_file[".env<br/>Configura\xe7\xf5es"]\r\n        nginx["\ud83d\udd0c Nginx<br/>Reverse Proxy"]\r\n        glitchtip["\ud83d\udc1b GlitchTip<br/>Error Tracking"]\r\n        portainer["\ud83d\udcca Portainer<br/>Container Mgmt"]\r\n        metabase["\ud83d\udcc8 Metabase<br/>BI Dashboard"]\r\n    end\r\n\r\n    subgraph Containers["\ud83d\udc33 Containers Docker"]\r\n        sqlserver["\ud83d\udcbe SQL Server<br/>Banco Principal"]\r\n        postgres["\ud83d\uddc4\ufe0f PostgreSQL<br/>Augmentations DB"]\r\n        redis["\u26a1 Redis<br/>Cache"]\r\n        minio["\ud83d\udce6 MinIO<br/>S3-Compatible"]\r\n        rabbitmq["\ud83d\udce8 RabbitMQ<br/>Message Broker"]\r\n    end\r\n\r\n    subgraph Services["\ud83d\udd0c Servi\xe7os Aplica\xe7\xe3o"]\r\n        backend["\ud83d\udd0c Backend API<br/>.NET 8<br/>Port 5000"]\r\n        frontend["\ud83c\udf10 Frontend<br/>React<br/>Port 5002"]\r\n        mobile["\ud83d\udcf1 Mobile<br/>React Native<br/>EAS Build"]\r\n    end\r\n\r\n    subgraph ML["\ud83e\udd16 Servi\xe7os IA"]\r\n        augmentations["\ud83c\udfa8 Augmentations<br/>Python<br/>GPU"]\r\n        training["\ud83e\udde0 Training<br/>TensorFlow<br/>GPU"]\r\n        classifier["\ud83e\udd16 Classifier<br/>FastAPI<br/>Port 5001"]\r\n    end\r\n\r\n    External --\x3e nginx\r\n    CI --\x3e selfhosted\r\n    github --\x3e actions\r\n    actions --\x3e selfhosted\r\n\r\n    nginx --\x3e backend\r\n    nginx --\x3e frontend\r\n    \r\n    backend --\x3e sqlserver\r\n    backend --\x3e minio\r\n    backend --\x3e rabbitmq\r\n    backend --\x3e redis\r\n    \r\n    frontend --\x3e backend\r\n    mobile --\x3e backend\r\n    \r\n    rabbitmq --\x3e augmentations\r\n    augmentations --\x3e postgres\r\n    augmentations --\x3e minio\r\n    \r\n    rabbitmq --\x3e training\r\n    training --\x3e postgres\r\n    training --\x3e minio\r\n    \r\n    classifier --\x3e postgres\r\n    classifier --\x3e minio\r\n    \r\n    glitchtip --\x3e postgres\r\n    metabase --\x3e sqlserver\r\n    portainer --\x3e Containers'}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-cicd-pipeline",children:"\ud83d\udd04 CI/CD Pipeline"}),"\n",(0,a.jsx)(n.h3,{id:"github-actions-workflows",children:"GitHub Actions Workflows"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:".github/workflows/\r\n\u251c\u2500\u2500 BuildExpoReactNativeAPK.yml    # Build do app mobile\r\n\u251c\u2500\u2500 DeployDockerHub.yml             # Push de imagens\r\n\u2514\u2500\u2500 SelfHostedDockerCompose.yml     # Build local com Docker Compose\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"fluxo-1-build-expo-react-native-apk",children:"Fluxo 1: Build Expo React Native APK"}),"\n",(0,a.jsx)(n.mermaid,{value:'graph LR\r\n    A["\ud83d\udcf1 Push para main/develop"] --\x3e B["\ud83d\ude80 GitHub Actions<br/>BuildExpoReactNativeAPK"]\r\n    B --\x3e C["\ud83d\udce5 Checkout c\xf3digo"]\r\n    C --\x3e D["\u2699\ufe0f Setup Node.js"]\r\n    D --\x3e E["\ud83d\udce6 npm install"]\r\n    E --\x3e F["\ud83d\udd28 eas build<br/>--platform android<br/>--build-profile preview"]\r\n    F --\x3e G["\ud83d\udcf1 APK gerado"]\r\n    G --\x3e H["\ud83d\udce4 Upload artifact"]\r\n    H --\x3e I["\ud83c\udf89 Pronto para teste"]\r\n\r\n    style A fill:#e1f5ff\r\n    style B fill:#fff3e0\r\n    style I fill:#c8e6c9'}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Arquivo:"})," ",(0,a.jsx)(n.code,{children:".github/workflows/BuildExpoReactNativeAPK.yml"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"name: Build Expo React Native APK\r\n\r\non:\r\n  push:\r\n    branches:\r\n      - main\r\n      - develop\r\n    paths:\r\n      - 'OColecionadorMobile/**'\r\n\r\njobs:\r\n  build:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - uses: actions/checkout@v4\r\n\r\n      - name: Setup Node.js\r\n        uses: actions/setup-node@v3\r\n        with:\r\n          node-version: '20'\r\n\r\n      - name: Install dependencies\r\n        working-directory: OColecionadorMobile\r\n        run: npm install\r\n\r\n      - name: Build APK with EAS\r\n        working-directory: OColecionadorMobile\r\n        run: |\r\n          npm install -g eas-cli\r\n          eas build \\\r\n            --platform android \\\r\n            --build-profile preview \\\r\n            --non-interactive\r\n\r\n      - name: Upload APK\r\n        uses: actions/upload-artifact@v3\r\n        with:\r\n          name: app-preview.apk\r\n          path: OColecionadorMobile/build/\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"fluxo-2-deploy-docker-hub",children:"Fluxo 2: Deploy Docker Hub"}),"\n",(0,a.jsx)(n.mermaid,{value:'graph LR\r\n    A["\ud83d\udc33 Docker Push Trigger"] --\x3e B["\ud83d\ude80 DeployDockerHub"]\r\n    B --\x3e C["\ud83d\udd10 Docker Login"]\r\n    C --\x3e D["\ud83d\udd28 Build Images"]\r\n    D --\x3e E["backend:latest"]\r\n    D --\x3e F["frontend:latest"]\r\n    D --\x3e G["augmentations:latest"]\r\n    E --\x3e H["\ud83d\udce4 Push to Hub"]\r\n    F --\x3e H\r\n    G --\x3e H\r\n    H --\x3e I["\ud83d\udc33 patrickcaloriocarvalho/<br/>ocolecionador-*"]\r\n\r\n    style A fill:#fce4ec\r\n    style I fill:#e0f2f1'}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Arquivo:"})," ",(0,a.jsx)(n.code,{children:".github/workflows/DeployDockerHub.yml"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"name: Deploy Docker Hub\r\n\r\non:\r\n  push:\r\n    branches:\r\n      - main\r\n    paths:\r\n      - 'OColecionadorBackEnd/**'\r\n      - 'OColecionadorFrontEnd/**'\r\n      - 'OColecionadorAugmentations/**'\r\n\r\njobs:\r\n  deploy:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - uses: actions/checkout@v4\r\n\r\n      - name: Set up Docker Buildx\r\n        uses: docker/setup-buildx-action@v2\r\n\r\n      - name: Login to Docker Hub\r\n        uses: docker/login-action@v2\r\n        with:\r\n          username: ${{ secrets.DOCKER_USERNAME }}\r\n          password: ${{ secrets.DOCKER_PASSWORD }}\r\n\r\n      - name: Build and push Backend\r\n        uses: docker/build-push-action@v4\r\n        with:\r\n          context: OColecionadorBackEnd\r\n          push: true\r\n          tags: |\r\n            patrickcaloriocarvalho/ocolecionador-backend:latest\r\n            patrickcaloriocarvalho/ocolecionador-backend:${{ github.sha }}\r\n\r\n      - name: Build and push Frontend\r\n        uses: docker/build-push-action@v4\r\n        with:\r\n          context: OColecionadorFrontEnd\r\n          push: true\r\n          tags: |\r\n            patrickcaloriocarvalho/ocolecionador-frontend:latest\r\n            patrickcaloriocarvalho/ocolecionador-frontend:${{ github.sha }}\r\n\r\n      - name: Build and push Augmentations\r\n        uses: docker/build-push-action@v4\r\n        with:\r\n          context: OColecionadorAugmentations\r\n          push: true\r\n          tags: |\r\n            patrickcaloriocarvalho/ocolecionador-augmentations:latest\r\n            patrickcaloriocarvalho/ocolecionador-augmentations:${{ github.sha }}\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"fluxo-3-self-hosted-docker-compose",children:"Fluxo 3: Self-Hosted Docker Compose"}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\r\n    participant GitHub as \ud83d\udc19 GitHub\r\n    participant Actions as \u2699\ufe0f GitHub Actions\r\n    participant Runner as \ud83d\udda5\ufe0f Self-Hosted Runner\r\n    participant Docker as \ud83d\udc33 Docker Daemon\r\n    participant Services as \ud83d\udd0c Servi\xe7os\r\n\r\n    GitHub->>Actions: Push PR detectado\r\n    Actions->>Runner: Dispatch workflow\r\n    Runner->>Runner: Checkout c\xf3digo\r\n    Runner->>Runner: Setup vari\xe1veis .env\r\n    Runner->>Docker: docker compose up --build\r\n    Docker->>Services: Inicia todos os containers\r\n    Services->>Docker: Health checks\r\n    Docker->>Runner: \u2713 Tudo pronto\r\n    Runner->>Actions: Workflow conclu\xeddo\r\n    Actions->>GitHub: Status check \u2713"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Arquivo:"})," ",(0,a.jsx)(n.code,{children:".github/workflows/SelfHostedDockerCompose.yml"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"name: Self Hosted Docker Compose\r\n\r\non:\r\n  pull_request:\r\n    types: [opened, synchronize, reopened]\r\n\r\njobs:\r\n  docker-compose:\r\n    runs-on: self-hosted  # Executa na m\xe1quina local\r\n    steps:\r\n      - name: Checkout do c\xf3digo\r\n        uses: actions/checkout@v4\r\n\r\n      - name: Setup vari\xe1veis de ambiente\r\n        run: |\r\n          cat > .env << EOF\r\n          OC_AUTH_USER=${{ secrets.OC_AUTH_USER }}\r\n          OC_AUTH_PASSWORD=${{ secrets.OC_AUTH_PASSWORD }}\r\n          OC_GITHUB_CLIENT_ID=${{ secrets.OC_GITHUB_CLIENT_ID }}\r\n          OC_GITHUB_CLIENT_SECRET=${{ secrets.OC_GITHUB_CLIENT_SECRET }}\r\n          OC_GOOGLE_CLIENT_ID=${{ secrets.OC_GOOGLE_CLIENT_ID }}\r\n          OC_GOOGLE_CLIENT_SECRET=${{ secrets.OC_GOOGLE_CLIENT_SECRET }}\r\n          OC_NGROK_TOKEN=${{ secrets.OC_NGROK_TOKEN }}\r\n          EOF\r\n\r\n      - name: Rodar Docker Compose\r\n        run: |\r\n          docker compose up -d --build --force-recreate\r\n\r\n      - name: Health checks\r\n        run: |\r\n          sleep 10\r\n          curl -f http://localhost:5000/api/health || exit 1\r\n          curl -f http://localhost:5002/health || exit 1\r\n\r\n      - name: Logs de erro\r\n        if: failure()\r\n        run: |\r\n          docker compose logs --tail=100\r\n          docker compose down\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-acesso-externo-via-ngrok",children:"\ud83c\udf0d Acesso Externo via ngrok"}),"\n",(0,a.jsx)(n.h3,{id:"configura\xe7\xe3o-de-tunneling",children:"Configura\xe7\xe3o de Tunneling"}),"\n",(0,a.jsx)(n.mermaid,{value:'graph LR\r\n    A["\ud83d\udcf1 Usu\xe1rio Externo<br/>Internet P\xfablica"] --\x3e B["\ud83d\udd17 ngrok Tunnel<br/>louse-model-lioness.ngrok-free.app"]\r\n    B --\x3e C["\ud83d\udd0c Nginx<br/>Reverse Proxy<br/>Port 80/443"]\r\n    C --\x3e D["\ud83c\udf10 Frontend<br/>Port 5002"]\r\n    C --\x3e E["\ud83d\udd0c Backend API<br/>Port 5000"]\r\n    \r\n    style A fill:#ffebee\r\n    style B fill:#fff3cd\r\n    style D fill:#d1ecf1\r\n    style E fill:#d4edda'}),"\n",(0,a.jsx)(n.h3,{id:"arquivo-docker-composeyml-ngrok",children:"Arquivo: docker-compose.yml (ngrok)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# docker-compose.yml - Servi\xe7o ngrok\r\nngrok:\r\n  image: ngrok/ngrok:latest\r\n  container_name: ngrok\r\n  command:\r\n    - "start"\r\n    - "--all"\r\n    - "--config"\r\n    - "/etc/ngrok.yml"\r\n  ports:\r\n    - "4040:4040"  # ngrok dashboard\r\n  environment:\r\n    NGROK_AUTHTOKEN: ${OC_NGROK_TOKEN}\r\n  volumes:\r\n    - ./LocalServer/ngrok.yml:/etc/ngrok.yml\r\n  depends_on:\r\n    - nginx\r\n  networks:\r\n    - ocolecionador\n'})}),"\n",(0,a.jsx)(n.h3,{id:"configura\xe7\xe3o-ngrok-ngrokyml",children:"Configura\xe7\xe3o ngrok (ngrok.yml)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'version: "3"\r\ntunnels:\r\n  frontend:\r\n    proto: http\r\n    addr: nginx:80\r\n    domain: "louse-model-lioness.ngrok-free.app"\r\n  \r\n  backend:\r\n    proto: http\r\n    addr: ocolecionadorbackend:5000\r\n    \r\n  classifier:\r\n    proto: http\r\n    addr: ocolecionadorclassifier:5001\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-nginx---reverse-proxy",children:"\ud83d\udd0c Nginx - Reverse Proxy"}),"\n",(0,a.jsx)(n.h3,{id:"arquivo-localservernginxconf",children:"Arquivo: LocalServer/nginx.conf"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-nginx",children:"upstream backend {\r\n    server ocolecionadorbackend:5000;\r\n}\r\n\r\nupstream frontend {\r\n    server ocolecionadorfrontend:5002;\r\n}\r\n\r\nupstream classifier {\r\n    server ocolecionadorclassifier:5001;\r\n}\r\n\r\nserver {\r\n    listen 80;\r\n    server_name louse-model-lioness.ngrok-free.app;\r\n\r\n    # Frontend\r\n    location / {\r\n        proxy_pass http://frontend;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Proto $scheme;\r\n    }\r\n\r\n    # Backend API\r\n    location /api {\r\n        proxy_pass http://backend;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Proto $scheme;\r\n    }\r\n\r\n    # Classifier API\r\n    location /classifier {\r\n        proxy_pass http://classifier;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n    }\r\n\r\n    # Gzip compression\r\n    gzip on;\r\n    gzip_types text/plain text/css application/json application/javascript text/xml application/xml;\r\n}\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-docker-compose---infraestrutura-completa",children:"\ud83d\udc33 Docker Compose - Infraestrutura Completa"}),"\n",(0,a.jsx)(n.h3,{id:"estrutura-de-servi\xe7os",children:"Estrutura de Servi\xe7os"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"# docker-compose.yml - Overview dos servi\xe7os\r\n\r\nservices:\r\n  # ========== BANCOS DE DADOS ==========\r\n  sqlserver:        # SQL Server 2022 (Backend)\r\n  postgres:         # PostgreSQL (Augmentations, Training, Classifier)\r\n  \r\n  # ========== INFRAESTRUTURA ==========\r\n  redis:            # Cache distribu\xeddo\r\n  minio:            # S3-compatible storage\r\n  rabbitmq:         # Message broker\r\n  \r\n  # ========== APLICA\xc7\xc3O ==========\r\n  ocolecionadorbackend:        # API .NET 8\r\n  ocolecionadorfrontend:       # React app\r\n  \r\n  # ========== IA / ML ==========\r\n  ocolecionadoraugmentations:  # Augmentations (GPU)\r\n  ocolecionadorclassifier:     # Classifica\xe7\xe3o (FastAPI)\r\n  ocolecionadortraining:       # Treinamento (GPU) - Manual\r\n\r\n  # ========== INFRAESTRUTURA LOCAL ==========\r\n  nginx:            # Reverse Proxy\r\n  ngrok:            # Tunneling externo\r\n  \r\n  # ========== MONITORAMENTO / ADMIN ==========\r\n  portainer:        # Docker UI\r\n  metabase:         # BI Dashboard\r\n  glitchtip:        # Error tracking\r\n  glitchtip-worker: # Worker para GlitchTip\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"exemplo-completo-docker-composeyml",children:"Exemplo Completo: docker-compose.yml"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\r\n\r\nservices:\r\n  # ========== BANCOS DE DADOS ==========\r\n  \r\n  sqlserver:\r\n    image: mcr.microsoft.com/mssql/server:2022-latest\r\n    container_name: sqlserver\r\n    environment:\r\n      MSSQL_PID: "Express"\r\n      ACCEPT_EULA: "Y"\r\n      MSSQL_SA_PASSWORD: ${OC_AUTH_PASSWORD}\r\n    ports:\r\n      - "1433:1433"\r\n    volumes:\r\n      - sqlserver_data:/var/opt/mssql\r\n    healthcheck:\r\n      test: /opt/mssql-tools/bin/sqlcmd -S localhost -U sa -P ${OC_AUTH_PASSWORD} -Q "SELECT 1"\r\n      interval: 10s\r\n      timeout: 3s\r\n      retries: 10\r\n    networks:\r\n      - ocolecionador\r\n\r\n  postgres:\r\n    image: postgres:15\r\n    container_name: postgres\r\n    environment:\r\n      POSTGRES_USER: ${OC_AUTH_USER}\r\n      POSTGRES_PASSWORD: ${OC_AUTH_PASSWORD}\r\n      POSTGRES_DB: OColecionadorAugmentationsDB\r\n    ports:\r\n      - "5432:5432"\r\n    volumes:\r\n      - postgres_data:/var/lib/postgresql/data\r\n      - ./OColecionadorAugmentations/init_db.sql:/docker-entrypoint-initdb.d/01_init.sql\r\n      - ./LocalServer/init_glitchtip.sql:/docker-entrypoint-initdb.d/02_glitchtip.sql\r\n    healthcheck:\r\n      test: ["CMD-SHELL", "pg_isready -U ${OC_AUTH_USER}"]\r\n      interval: 10s\r\n      timeout: 3s\r\n      retries: 5\r\n    networks:\r\n      - ocolecionador\r\n\r\n  # ========== INFRAESTRUTURA ==========\r\n\r\n  redis:\r\n    image: redis:7\r\n    container_name: redis\r\n    ports:\r\n      - "6379:6379"\r\n    volumes:\r\n      - redis_data:/data\r\n    command: redis-server --appendonly yes\r\n    healthcheck:\r\n      test: ["CMD", "redis-cli", "ping"]\r\n      interval: 10s\r\n      timeout: 3s\r\n      retries: 5\r\n    networks:\r\n      - ocolecionador\r\n\r\n  minio:\r\n    image: minio/minio\r\n    container_name: minio\r\n    ports:\r\n      - "9000:9000"\r\n      - "9001:9001"\r\n    environment:\r\n      MINIO_ROOT_USER: ${OC_AUTH_USER}\r\n      MINIO_ROOT_PASSWORD: ${OC_AUTH_PASSWORD}\r\n    command: server /data --console-address ":9001"\r\n    volumes:\r\n      - minio_data:/data\r\n    healthcheck:\r\n      test: ["CMD", "curl", "-f", "http://localhost:9000/minio/health/live"]\r\n      interval: 10s\r\n      timeout: 3s\r\n      retries: 5\r\n    networks:\r\n      - ocolecionador\r\n\r\n  rabbitmq:\r\n    image: rabbitmq:3-management\r\n    container_name: rabbitmq\r\n    ports:\r\n      - "5672:5672"\r\n      - "15672:15672"\r\n    environment:\r\n      RABBITMQ_DEFAULT_USER: ${OC_AUTH_USER}\r\n      RABBITMQ_DEFAULT_PASS: ${OC_AUTH_PASSWORD}\r\n    volumes:\r\n      - rabbitmq_data:/var/lib/rabbitmq\r\n    healthcheck:\r\n      test: ["CMD", "rabbitmq-diagnostics", "ping"]\r\n      interval: 10s\r\n      timeout: 3s\r\n      retries: 5\r\n    networks:\r\n      - ocolecionador\r\n\r\n  # ========== APLICA\xc7\xc3O ==========\r\n\r\n  ocolecionadorbackend:\r\n    build:\r\n      context: ./OColecionadorBackEnd\r\n      dockerfile: Dockerfile\r\n    container_name: OColecionadorBackEnd\r\n    depends_on:\r\n      sqlserver:\r\n        condition: service_healthy\r\n      minio:\r\n        condition: service_healthy\r\n      rabbitmq:\r\n        condition: service_healthy\r\n    environment:\r\n      ASPNETCORE_ENVIRONMENT: Production\r\n      DOCKER_URI: "unix:///var/run/docker.sock"\r\n    ports:\r\n      - "5000:8080"\r\n    volumes:\r\n      - /var/run/docker.sock:/var/run/docker.sock\r\n    restart: always\r\n    networks:\r\n      - ocolecionador\r\n\r\n  ocolecionadorfrontend:\r\n    build:\r\n      context: ./OColecionadorFrontEnd\r\n      dockerfile: Dockerfile\r\n      args:\r\n        GITHUB_CLIENT_ID: ${OC_GITHUB_CLIENT_ID}\r\n        GOOGLE_CLIENT_ID: ${OC_GOOGLE_CLIENT_ID}\r\n    container_name: OColecionadorFrontEnd\r\n    depends_on:\r\n      - ocolecionadorbackend\r\n    ports:\r\n      - "5002:5002"\r\n    restart: always\r\n    networks:\r\n      - ocolecionador\r\n\r\n  # ========== IA / ML ==========\r\n\r\n  ocolecionadoraugmentations:\r\n    build: ./OColecionadorAugmentations\r\n    container_name: OColecionadorAugmentations\r\n    runtime: nvidia\r\n    gpus:\r\n      - capabilities: [gpu]\r\n    depends_on:\r\n      postgres:\r\n        condition: service_healthy\r\n      minio:\r\n        condition: service_healthy\r\n      rabbitmq:\r\n        condition: service_healthy\r\n    environment:\r\n      POSTGRES_HOST: postgres\r\n      MINIO_HOST: minio\r\n      RABBITMQ_HOST: rabbitmq\r\n      CUDA_VISIBLE_DEVICES: "0"\r\n    restart: always\r\n    networks:\r\n      - ocolecionador\r\n    profiles:\r\n      - "automatic"\r\n\r\n  ocolecionadorclassifier:\r\n    build: ./OColecionadorClassifier\r\n    container_name: OColecionadorClassifier\r\n    ports:\r\n      - "5001:5001"\r\n    depends_on:\r\n      postgres:\r\n        condition: service_healthy\r\n      minio:\r\n        condition: service_healthy\r\n    environment:\r\n      POSTGRES_HOST: postgres\r\n      MINIO_HOST: minio\r\n      MODEL_PATH: /app/models/v2\r\n    restart: always\r\n    networks:\r\n      - ocolecionador\r\n    profiles:\r\n      - "automatic"\r\n\r\n  ocolecionadortraining:\r\n    build: ./OColecionadorTraining\r\n    container_name: OColecionadorTraining\r\n    runtime: nvidia\r\n    gpus:\r\n      - capabilities: [gpu]\r\n    depends_on:\r\n      postgres:\r\n        condition: service_healthy\r\n      minio:\r\n        condition: service_healthy\r\n      rabbitmq:\r\n        condition: service_healthy\r\n    environment:\r\n      POSTGRES_HOST: postgres\r\n      MINIO_HOST: minio\r\n      RABBITMQ_HOST: rabbitmq\r\n      CUDA_VISIBLE_DEVICES: "0"\r\n    networks:\r\n      - ocolecionador\r\n    profiles:\r\n      - "manual"\r\n    command: /bin/bash -c "while true; do sleep 1000; done"\r\n\r\n  # ========== INFRAESTRUTURA LOCAL ==========\r\n\r\n  nginx:\r\n    image: nginx:alpine\r\n    container_name: nginx\r\n    ports:\r\n      - "80:80"\r\n      - "443:443"\r\n    volumes:\r\n      - ./LocalServer/nginx.conf:/etc/nginx/nginx.conf:ro\r\n    depends_on:\r\n      - ocolecionadorbackend\r\n      - ocolecionadorfrontend\r\n    networks:\r\n      - ocolecionador\r\n\r\n  ngrok:\r\n    image: ngrok/ngrok:latest\r\n    container_name: ngrok\r\n    command:\r\n      - "start"\r\n      - "--all"\r\n      - "--config"\r\n      - "/etc/ngrok.yml"\r\n    ports:\r\n      - "4040:4040"\r\n    environment:\r\n      NGROK_AUTHTOKEN: ${OC_NGROK_TOKEN}\r\n    volumes:\r\n      - ./LocalServer/ngrok.yml:/etc/ngrok.yml:ro\r\n    depends_on:\r\n      - nginx\r\n    networks:\r\n      - ocolecionador\r\n\r\n  # ========== MONITORAMENTO / ADMIN ==========\r\n\r\n  portainer:\r\n    image: portainer/portainer-ce:latest\r\n    container_name: portainer\r\n    ports:\r\n      - "9443:9443"\r\n      - "8000:8000"\r\n    volumes:\r\n      - /var/run/docker.sock:/var/run/docker.sock\r\n      - portainer_data:/data\r\n    networks:\r\n      - ocolecionador\r\n\r\n  metabase:\r\n    image: metabase/metabase:latest\r\n    container_name: metabase\r\n    ports:\r\n      - "3000:3000"\r\n    environment:\r\n      MB_DB_TYPE: postgres\r\n      MB_DB_DBNAME: metabase\r\n      MB_DB_USER: ${OC_AUTH_USER}\r\n      MB_DB_PASS: ${OC_AUTH_PASSWORD}\r\n      MB_DB_HOST: postgres\r\n      MB_DB_PORT: 5432\r\n    depends_on:\r\n      postgres:\r\n        condition: service_healthy\r\n    networks:\r\n      - ocolecionador\r\n\r\n  glitchtip:\r\n    image: glitchtip/glitchtip:latest\r\n    container_name: glitchtip\r\n    ports:\r\n      - "8000:8000"\r\n    environment:\r\n      DATABASE_URL: postgres://${OC_AUTH_USER}:${OC_AUTH_PASSWORD}@postgres:5432/glitchtip\r\n      SECRET_KEY: ${GLITCHTIP_SECRET_KEY}\r\n      ALLOWED_HOSTS: glitchtip\r\n    depends_on:\r\n      postgres:\r\n        condition: service_healthy\r\n    networks:\r\n      - ocolecionador\r\n\r\n  glitchtip_worker:\r\n    image: glitchtip/glitchtip:latest\r\n    container_name: glitchtip_worker\r\n    command: celery -A glitchtip_project worker -l info\r\n    environment:\r\n      DATABASE_URL: postgres://${OC_AUTH_USER}:${OC_AUTH_PASSWORD}@postgres:5432/glitchtip\r\n      SECRET_KEY: ${GLITCHTIP_SECRET_KEY}\r\n    depends_on:\r\n      - postgres\r\n      - glitchtip\r\n    networks:\r\n      - ocolecionador\r\n\r\n# ========== VOLUMES ==========\r\n\r\nvolumes:\r\n  sqlserver_data:\r\n  postgres_data:\r\n  minio_data:\r\n  redis_data:\r\n  rabbitmq_data:\r\n  portainer_data:\r\n\r\n# ========== NETWORKS ==========\r\n\r\nnetworks:\r\n  ocolecionador:\r\n    driver: bridge\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-execu\xe7\xe3o-com-perfis",children:"\ud83d\ude80 Execu\xe7\xe3o com Perfis"}),"\n",(0,a.jsx)(n.h3,{id:"perfil-autom\xe1tico-produ\xe7\xe3o",children:"Perfil: Autom\xe1tico (Produ\xe7\xe3o)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Inicia todos os servi\xe7os autom\xe1ticos\r\ndocker compose --profile automatic up -d\r\n\r\n# Inclui:\r\n# - Todos os bancos de dados\r\n# - Backend e Frontend\r\n# - Augmentations\r\n# - Classifier\r\n# - Nginx + ngrok\r\n# - Portainer, Metabase, GlitchTip\n"})}),"\n",(0,a.jsx)(n.h3,{id:"perfil-manual-desenvolvimento",children:"Perfil: Manual (Desenvolvimento)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Inicia apenas servi\xe7os base\r\ndocker compose --profile manual up -d\r\n\r\n# Depois inicia Training manualmente\r\ndocker compose start ocolecionadortraining\r\n\r\n# Ou executa comandos espec\xedficos\r\ndocker compose exec ocolecionadortraining python main.py\n"})}),"\n",(0,a.jsx)(n.h3,{id:"todos-os-servi\xe7os",children:"Todos os Servi\xe7os"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Inicia TUDO (autom\xe1tico + manual)\r\ndocker compose up -d\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-vari\xe1veis-de-ambiente-env",children:"\ud83d\udd10 Vari\xe1veis de Ambiente (.env)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Arquivo: .env (na raiz do projeto)\r\n\r\n# ========== AUTENTICA\xc7\xc3O ==========\r\nOC_AUTH_USER=OColecionadorUser\r\nOC_AUTH_PASSWORD=OColecionador@2025\r\nOC_AUTH_EMAIL=admin@ocolecionador.local\r\n\r\n# ========== OAUTH2 ==========\r\nOC_GITHUB_CLIENT_ID=seu_github_id\r\nOC_GITHUB_CLIENT_SECRET=seu_github_secret\r\nOC_GOOGLE_CLIENT_ID=seu_google_id\r\nOC_GOOGLE_CLIENT_SECRET=seu_google_secret\r\n\r\n# ========== NGROK ==========\r\nOC_NGROK_TOKEN=seu_ngrok_token\r\n\r\n# ========== GLITCHTIP ==========\r\nGLITCHTIP_SECRET_KEY=gerar_chave_aleatoria_aqui\r\n\r\n# ========== SENTRY (Error Tracking) ==========\r\nSENTRY_DSN=http://glitchtip:8000/3\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-dashboard-e-ferramentas",children:"\ud83d\udcca Dashboard e Ferramentas"}),"\n",(0,a.jsx)(n.h3,{id:"acesso-aos-pain\xe9is",children:"Acesso aos Pain\xe9is"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Ferramenta"}),(0,a.jsx)(n.th,{children:"URL"}),(0,a.jsx)(n.th,{children:"Usu\xe1rio"}),(0,a.jsx)(n.th,{children:"Fun\xe7\xe3o"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Frontend"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"https://louse-model-lioness.ngrok-free.app",children:"https://louse-model-lioness.ngrok-free.app"})}),(0,a.jsx)(n.td,{children:"OAuth2"}),(0,a.jsx)(n.td,{children:"App principal"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Backend API"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"https://louse-model-lioness.ngrok-free.app/api",children:"https://louse-model-lioness.ngrok-free.app/api"})}),(0,a.jsx)(n.td,{children:"Token"}),(0,a.jsx)(n.td,{children:"API REST"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Classifier"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"http://localhost:5001",children:"http://localhost:5001"})}),(0,a.jsx)(n.td,{children:"-"}),(0,a.jsx)(n.td,{children:"Classifica\xe7\xe3o IA"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Portainer"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"https://localhost:9443",children:"https://localhost:9443"})}),(0,a.jsx)(n.td,{children:"Admin"}),(0,a.jsx)(n.td,{children:"Docker UI"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Metabase"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"http://localhost:3000",children:"http://localhost:3000"})}),(0,a.jsx)(n.td,{children:"Admin"}),(0,a.jsx)(n.td,{children:"BI Dashboard"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"GlitchTip"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"http://localhost:8000",children:"http://localhost:8000"})}),(0,a.jsx)(n.td,{children:"Admin"}),(0,a.jsx)(n.td,{children:"Error tracking"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"pgAdmin"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"http://localhost:5050",children:"http://localhost:5050"})}),(0,a.jsx)(n.td,{children:"Admin"}),(0,a.jsx)(n.td,{children:"PostgreSQL UI"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"MinIO Console"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"http://localhost:9001",children:"http://localhost:9001"})}),(0,a.jsx)(n.td,{children:"User"}),(0,a.jsx)(n.td,{children:"S3 Storage"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"RabbitMQ"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"http://localhost:15672",children:"http://localhost:15672"})}),(0,a.jsx)(n.td,{children:"User"}),(0,a.jsx)(n.td,{children:"Message Broker"})]})]})]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-monitoramento-de-health-checks",children:"\ud83d\udd0d Monitoramento de Health Checks"}),"\n",(0,a.jsx)(n.mermaid,{value:'graph LR\r\n    A["Health Check"] --\x3e B{Status}\r\n    B --\x3e|Healthy| C["\ud83d\udfe2 Green"]\r\n    B --\x3e|Unhealthy| D["\ud83d\udd34 Red"]\r\n    \r\n    C --\x3e E["Services rodando"]\r\n    D --\x3e F["Investigar logs"]\r\n    F --\x3e G["docker compose logs -f service"]'}),"\n",(0,a.jsx)(n.h3,{id:"comando-para-verificar-sa\xfade",children:"Comando para Verificar Sa\xfade"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Ver status de todos os containers\r\ndocker compose ps\r\n\r\n# Ver logs de um servi\xe7o espec\xedfico\r\ndocker compose logs -f ocolecionadorbackend\r\n\r\n# Executar health check manual\r\ndocker exec ocolecionadorbackend curl -f http://localhost:8080/api/health\r\n\r\n# Ver uso de recursos\r\ndocker stats\r\n\r\n# Verificar volumes\r\ndocker volume ls\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-troubleshooting",children:"\ud83d\udea8 Troubleshooting"}),"\n",(0,a.jsx)(n.h3,{id:"backend-n\xe3o-conecta-ao-sql-server",children:"Backend n\xe3o conecta ao SQL Server"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Verifique se SQL Server est\xe1 rodando\r\ndocker ps | grep sqlserver\r\n\r\n# Teste conex\xe3o\r\ndocker exec ocolecionadorbackend curl -f http://localhost:8080/api/health\r\n\r\n# Ver logs\r\ndocker compose logs sqlserver\n"})}),"\n",(0,a.jsx)(n.h3,{id:"ngrok-n\xe3o-conecta",children:"Ngrok n\xe3o conecta"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Verifique token\r\necho $OC_NGROK_TOKEN\r\n\r\n# Verifique status\r\ncurl http://localhost:4040/api/tunnels\r\n\r\n# Reinicie ngrok\r\ndocker compose restart ngrok\n"})}),"\n",(0,a.jsx)(n.h3,{id:"augmentations-n\xe3o-consome-da-fila",children:"Augmentations n\xe3o consome da fila"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Verifique RabbitMQ\r\ndocker compose logs rabbitmq\r\n\r\n# Acesse dashboard RabbitMQ\r\ncurl http://localhost:15672 -u user:pass\r\n\r\n# Verifique fila\r\ndocker exec rabbitmq rabbitmqctl list_queues\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-fluxo-completo-de-deployment",children:"\ud83d\udcc8 Fluxo Completo de Deployment"}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\r\n    participant Dev as \ud83d\udc68\u200d\ud83d\udcbb Developer\r\n    participant GitHub as \ud83d\udc19 GitHub\r\n    participant CI as \u2699\ufe0f CI/CD\r\n    participant Runner as \ud83d\udda5\ufe0f Runner\r\n    participant DockerHub as \ud83d\udc33 Docker Hub\r\n    participant Prod as \ud83c\udfe0 Production\r\n\r\n    Dev->>GitHub: Push c\xf3digo\r\n    GitHub->>CI: Trigger workflows\r\n    \r\n    alt BuildExpo\r\n        CI->>Runner: Build APK\r\n        Runner->>CI: APK pronto\r\n        CI->>GitHub: Upload artifact\r\n    end\r\n    \r\n    alt DeployDockerHub\r\n        CI->>Runner: Build Docker images\r\n        Runner->>DockerHub: Push images\r\n        DockerHub->>Prod: Pull latest\r\n    end\r\n    \r\n    alt SelfHostedDockerCompose\r\n        CI->>Runner: docker compose up\r\n        Runner->>Prod: Inicia containers\r\n        Prod->>Prod: Health checks\r\n        Runner->>CI: \u2713 Tudo OK\r\n    end\r\n    \r\n    CI->>GitHub: Status check\r\n    GitHub->>Dev: \u2713 Build passou"}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-conclus\xe3o",children:"\ud83c\udfaf Conclus\xe3o"}),"\n",(0,a.jsx)(n.p,{children:"A infraestrutura do OColecionador \xe9:"}),"\n",(0,a.jsxs)(n.p,{children:["\u2705 ",(0,a.jsx)(n.strong,{children:"Modular"})," \u2013 Cada servi\xe7o \xe9 um container independente",(0,a.jsx)(n.br,{}),"\n","\u2705 ",(0,a.jsx)(n.strong,{children:"Escal\xe1vel"})," \u2013 Suporta m\xfaltiplas inst\xe2ncias com load balancer",(0,a.jsx)(n.br,{}),"\n","\u2705 ",(0,a.jsx)(n.strong,{children:"Resiliente"})," \u2013 Health checks e restart policies",(0,a.jsx)(n.br,{}),"\n","\u2705 ",(0,a.jsx)(n.strong,{children:"Monitorado"})," \u2013 GlitchTip, Metabase, Portainer",(0,a.jsx)(n.br,{}),"\n","\u2705 ",(0,a.jsx)(n.strong,{children:"Acess\xedvel"})," \u2013 ngrok tunnel para acesso externo",(0,a.jsx)(n.br,{}),"\n","\u2705 ",(0,a.jsx)(n.strong,{children:"Automatizado"})," \u2013 CI/CD via GitHub Actions",(0,a.jsx)(n.br,{}),"\n","\u2705 ",(0,a.jsx)(n.strong,{children:"Isolado"})," \u2013 Redes Docker para segrega\xe7\xe3o"]}),"\n",(0,a.jsx)(n.p,{children:"Todos os servi\xe7os trabalham em conjunto atrav\xe9s de Docker Compose, com perfis espec\xedficos para desenvolvimento vs produ\xe7\xe3o."})]})}function u(r={}){const{wrapper:n}={...(0,i.R)(),...r.components};return n?(0,a.jsx)(n,{...r,children:(0,a.jsx)(d,{...r})}):d(r)}}}]);